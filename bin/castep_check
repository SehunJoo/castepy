#!/bin/bash


for dir in $(find ./ -mindepth 1 -maxdepth 1 -type d | sort)
do
    echo
    echo "====================================================================="
    echo $dir
    echo "====================================================================="
    echo

    cd $dir

    cell=$(find ./ -maxdepth 1 -type f -name "*.cell" | grep -v "out.cell")
    param=$(find ./ -maxdepth 1 -type f -name "*.param")
    echo "$cell"
    echo "$param"
    echo

    echo "IONIC CONSTRAINTS"; echo
    nline=$(sed -n '/^%BLOCK IONIC_CONSTRAINTS/,/^%ENDBLOCK/p' $cell | wc -l)
    if [[ $nline -le 2 ]]; then
        echo "No, $nline"
    else
        echo "Yes, $nline"
    fi
    echo

    echo "WARNINGS"; echo
    grep -i warning *.castep | sort | uniq
    echo

    cd ../




done
